"The Quarrel" by Zane Mariano & Jon Gill

Include Basic Screen Effects by Emily Short.
Include Reactable Quips by Michael Martin.
Release along with an interpreter, the source text and a website.
Use no scoring.

Chapter I - Values

[Data]
Genre_value is a number that varies.

Chapter II - Actions
	
[FASTFORWARD Action]	
Fastforwarding is an action applying to nothing.
Understand "do_fastforward" as fastforwarding.

move_to_room is a room that varies.
Instead of fastforwarding:
	let is_next_room be false;
	if location is solved_noir:
		let is_next_room be whether or not there is a next_room_noir corresponding to a curr_room of the location in the table of room connections;
		if is_next_room is true:
			now move_to_room is the next_room_noir corresponding to a curr_room of the location in the table of room connections;
		otherwise:
			say "Nowhere to go.";
	otherwise if location is solved_romance:
		let is_next_room be whether or not there is a next_room_romance corresponding to a curr_room of the location in the table of room connections;
		if is_next_room is true:
			now move_to_room is the next_room_romance corresponding to a curr_room of the location in the table of room connections;
		otherwise:
			say "Drat!  There's nowhere for you to go.";
	otherwise:
		say "There's still work to be done here.";
	if is_next_room is true:
		move the player to move_to_room, without printing a room description;
		try resetting;
		move the player to move_to_room;
		

[REWIND Action]
Rewinding is an action applying to nothing.
Understand "rewind" as rewinding.

prev_room_trans is text that varies.
Instead of rewinding:
	let is_prev_room be false;
	let is_prev_room be whether or not there is a prev_room corresponding to a curr_room of the location in the table of room connections;
	if is_prev_room is true:
		say the description corresponding to a curr_room of the location in the table of rewind descriptions;
		if the player consents:
			now move_to_room is the prev_room corresponding to a curr_room of the location in the table of room connections;
			move the player to move_to_room, without printing a room description;
			try resetting;
			move the player to move_to_room;
	otherwise:
		say "This is where it all beganâ€¦";
	

[RESET Action]
Resetting is an action applying to nothing.
Understand "test_reset" as resetting.
	
[Override RESET for each specific room.]


[Ending the game]
Ending_text_room is a room that varies.
After resetting when the location is ending_room:
	now ending_text_room is the location;
	the fat lady sings in the ending_turns of the location - 1 turns from now.

Every turn when the location is ending_text_room:
	say "[the ending_text of ending_text_room]";
	
At the time when the fat lady sings:
	end the game saying "THE END".
	

[--------------- Player Action Descriptions ---------------]


[UTILIZE]

[Utilize is the version of Use that applies to a single object]
Utilizing is an action applying to one visible thing.
Understand "utilize [something]" as utilizing.
Understand "use [something]" as utilizing.

[Implement precise use cases in-line when necessary by including lines like those below:]
Carry out utilizing:
    if the noun is the knife, say "You pick your teeth with the blade." instead.


[USE]

[Use affects one object with another]
Using is an action applying to two visible things.
Understand "use [something] on [something]" as using.
Understand "use [something] with [something]" as using.
Understand "apply [something] to [something]" as using.

[Implement precise use cases in-line when necessary by including lines like those below:]
Check using: 
    if the noun is the knife and the second noun is Charles, say "Good idea." instead;
    if the noun is the knife, say "That would hurt." instead.

[We can use as many Check using blocks as we need.]
Check using:
    if the noun is Charles, say "There is no use for Charles." instead.


[HELP]

Helping is an action applying to nothing. Understand "help" as helping.
After helping when genre_value is less than 0:
	say "[RED LETTERS] Time to EXAMINE myself.  Really take a deep LOOK inside.  I was a hard man, with hard convictions.  I'd USE and TAKE, but I'd rarely ASK before I did.[BLACK LETTERS]";
After helping when genre_value is 0:
	say "This is generic help text.";
After helping when genre_value is greater than 0:
	say "This is romantic help text.";


[EXAMINE ME]

Instead of examining player when genre_value is less than 0: say "Noir description."
Instead of examining player when genre_value is 0: say "Generic description."
Instead of examining player when genre_value is greater than 0: say "Romance description."


[GO N/S/E/W]

Instead of going when genre_value is less than 0: say "[RED LETTERS]Yes, part of me wanted to run.  But this was where I had to be. [BLACK LETTERS]".
Instead of going when genre_value is 0: say "[BLUE LETTERS]Oh, bother!  You still have  [RED LETTERS] work to do.  Messy work.[BLACK LETTERS]".
Instead of going when genre_value is greater than 0: say "Romance going."

[Instead of doing something other than looking, examining, asking, telling, or going, say "HAHAHA NO."]

Chapter III - Conversations


[TALKING Action]

Talking is an action applying to one thing.
Understand "talk [something]" and "talk to [something]" as talking.
Check talking: try asking the noun about "the_default".


[--------------- Conversation Content -- Can be continued in other Chapters ---------------]


    Table of Ask Results (continued)
  	NPC  		topic  					result  
  	Charles	  	"his face" or "ugliness"			hate my face
	Charles		"the_default"				want to die

    Table of Tell Results (continued)
  	NPC  		topic			  		result  
  	Charles  		"sucks"				  	hate my face

    Table of Quip Texts (continued)
  	quip  		quiptext  
  	hate my face	"Yeah, it kind of sucks.  I'm pretty hideous."
	want to die	"You're right.  I should kill myself."

    Table of Quip Followups (continued)
  	quip  		option  					result  
  	hate my face  	"Life isn't really worth living for you."		want to die
  	hate my face  	"You're freaking hideous man."  		want to die

[Quip Results]

    After quipping when the current quip is want to die: end the story saying "Charles goes off to hang himself.  Rough.".

Charles is a person.  Charles is in Test.

Chapter IV - Rooms

[Room state]
A room can be unsolved, solved_noir, or solved_romance.  A room is usually unsolved.
Rooms have a text called ending_text.
Rooms have a number called ending_turns.
Rooms can be ending_room. A room is usually not ending_room.

[Room Relations]
    Table of Room Connections
	curr_room		next_room_noir	next_room_romance		prev_room
	Intro		Test		Test			--
	Test		--		--			Intro
	
    Table of Rewind Descriptions
	curr_room		description
	Intro		--
	Test		"Going back?  "


Intro is a room with printed name "The Closet: Trapped".
Understand "The Closet" and "Closet" as Intro.
The description of Intro is "You wake up in a room surrounded by shit and stuff. It's also pretty dark in here. Sucks."

[Test Scenario]
Intro is solved_noir.

Test is east of Intro.
The knife is an object in Test.

Test is ending_room.
The ending_text of Test is "[one of]Helloooo![or]Is anybody there?[or]Well, this is it.[stopping]".
The ending_turns of Test is 3.
Carry out resetting when the player is in Test: 
	now the knife is in Test;
	now genre_value is 1.


[Noir Scenes]
NoirScene1 is a room with printed name "PI Office".
Understand "PI Office" as NoirScene1.
The description of NoirScene1 is "THIS IS A TEMP DESCRIPTION!!!".

NoirScene2 is a room with printed name "The Park: Midnight".
Understand "The Park" and "Park" and "Midnight" as NoirScene2.
The description of NoirScene2 is "THIS IS A TEMP DESCRIPTION!!!".

NoirScene3a is a room with printed name "Victim's House".
Understand "Victim's House" as NoirScene3a.
The description of NoirScene3a is "THIS IS A TEMP DESCRIPTION!!!".

NoirScene3b is a room with printed name "Celine's Hotel".
Understand "Celine's Hotel" as NoirScene3b.
The description of NoirScene3b is "THIS IS A TEMP DESCRIPTION!!!".


[Romance Scenes]
RomScene1 is room with printed name "Accounting Office".
Understand "Accounting Office" as RomScene1.
The description of RomScene1 is "THIS IS A TEMP DESCRIPTION!!!".

RomScene2 is room with printed name "The Park: Noon".
Understand "The Park" and "Park" and "Noon" as RomScene2.
The description of RomScene2 is "THIS IS A TEMP DESCRIPTION!!!".

RomScene3a is room with printed name "Celine's Bedroom".
Understand "Celine's Bedroom" as RomScene3a.
The description of RomScene3a is "THIS IS A TEMP DESCRIPTION!!!".

RomScene3b is room with printed name "Celine's Driveway".
Understand "Celine's Driveway" as RomScene3b.
The description of RomScene3b is "THIS IS A TEMP DESCRIPTION!!!".


Chapter V - Game Setup

The player is in Intro.

[GAME START]
When play begins:
	now genre_value is 0.

